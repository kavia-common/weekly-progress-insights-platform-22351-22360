{"is_source_file": true, "format": "JavaScript/React JSX", "description": "This file defines a React component 'AdminUsers' that provides a user interface for managing user roles in an admin section. It includes logic for fetching and updating users via backend services, conditional guidance for configuring backend API, and displays user data with role management controls.", "external_files": ["../context/AuthContext", "../components/ToastProvider", "../components/ConfigWarning", "../lib/supabaseClient", "../services/userAdminService", "../components/ToastProvider", "react-router-dom"], "external_methods": ["useAuth", "useToast", "getSupabase", "getSupabaseConfigStatus", "fetchUsers", "updateUserRole", "getAdminApiStatus", "Link"], "published": ["AdminUsers"], "classes": [], "methods": [{"name": "loadUsers", "description": "Fetches users from backend API and updates component state, displaying success or error messages."}, {"name": "tryLoadOwnProfile", "description": "Attempts to load the current user's profile role from Supabase, if configured."}, {"name": "normalizeRole", "description": "Normalizes the role attribute from user data to lowercase string."}, {"name": "onChangeRole", "description": "Handles role change requests, updating user roles via backend service and updating local state."}], "calls": ["getSupabaseConfigStatus()", "getSupabase()", "useToast()", "useAuth()", "getAdminApiStatus()", "fetchUsers()", "addToast()", "getSupabase().from('profiles').select()", "updateUserRole()"], "search-terms": ["AdminUsers React component", "user role management React", "fetchUsers service", "updateUserRole service", "supabaseClient", "Admin route React", "role management UI", "Backend API configuration"], "state": 2, "file_id": 44, "knowledge_revision": 140, "git_revision": "", "ctags": [{"_type": "tag", "name": "AdminUsers", "path": "/home/kavia/workspace/code-generation/weekly-progress-insights-platform-22351-22360/weekly_report_frontend/src/pages/AdminUsers.jsx", "pattern": "/^const AdminUsers = () => {$/", "language": "JavaScript", "kind": "constant"}, {"_type": "tag", "name": "Guidance", "path": "/home/kavia/workspace/code-generation/weekly-progress-insights-platform-22351-22360/weekly_report_frontend/src/pages/AdminUsers.jsx", "pattern": "/^  const Guidance = () => ($/", "language": "JavaScript", "kind": "constant"}, {"_type": "tag", "name": "allowedRoles", "path": "/home/kavia/workspace/code-generation/weekly-progress-insights-platform-22351-22360/weekly_report_frontend/src/pages/AdminUsers.jsx", "pattern": "/^  const allowedRoles = ['employee', 'manager', 'admin'];$/", "language": "JavaScript", "kind": "constant"}, {"_type": "tag", "name": "email", "path": "/home/kavia/workspace/code-generation/weekly-progress-insights-platform-22351-22360/weekly_report_frontend/src/pages/AdminUsers.jsx", "pattern": "/^    const email = u?.email || u?.user_email || null;$/", "language": "JavaScript", "kind": "constant"}, {"_type": "tag", "name": "loadUsers", "path": "/home/kavia/workspace/code-generation/weekly-progress-insights-platform-22351-22360/weekly_report_frontend/src/pages/AdminUsers.jsx", "pattern": "/^            onClick={loadUsers}$/", "language": "JavaScript", "kind": "field", "scope": "onClick", "scopeKind": "class"}, {"_type": "tag", "name": "loadUsers", "path": "/home/kavia/workspace/code-generation/weekly-progress-insights-platform-22351-22360/weekly_report_frontend/src/pages/AdminUsers.jsx", "pattern": "/^  const loadUsers = React.useCallback(async () => {$/", "language": "JavaScript", "kind": "constant"}, {"_type": "tag", "name": "loading", "path": "/home/kavia/workspace/code-generation/weekly-progress-insights-platform-22351-22360/weekly_report_frontend/src/pages/AdminUsers.jsx", "pattern": "/^            aria-busy={loading ? 'true' : 'false'}$/", "language": "JavaScript", "kind": "field", "scope": "aria", "scopeKind": "class"}, {"_type": "tag", "name": "loading", "path": "/home/kavia/workspace/code-generation/weekly-progress-insights-platform-22351-22360/weekly_report_frontend/src/pages/AdminUsers.jsx", "pattern": "/^            disabled={loading}$/", "language": "JavaScript", "kind": "field", "scope": "disabled", "scopeKind": "class"}, {"_type": "tag", "name": "normalizeRole", "path": "/home/kavia/workspace/code-generation/weekly-progress-insights-platform-22351-22360/weekly_report_frontend/src/pages/AdminUsers.jsx", "pattern": "/^  const normalizeRole = (u) => {$/", "language": "JavaScript", "kind": "constant"}, {"_type": "tag", "name": "onChangeRole", "path": "/home/kavia/workspace/code-generation/weekly-progress-insights-platform-22351-22360/weekly_report_frontend/src/pages/AdminUsers.jsx", "pattern": "/^  const onChangeRole = async (u, nextRole) => {$/", "language": "JavaScript", "kind": "constant"}, {"_type": "tag", "name": "r", "path": "/home/kavia/workspace/code-generation/weekly-progress-insights-platform-22351-22360/weekly_report_frontend/src/pages/AdminUsers.jsx", "pattern": "/^    const r =$/", "language": "JavaScript", "kind": "constant"}, {"_type": "tag", "name": "res", "path": "/home/kavia/workspace/code-generation/weekly-progress-insights-platform-22351-22360/weekly_report_frontend/src/pages/AdminUsers.jsx", "pattern": "/^      const res = await updateUserRole({ userId, email, role: nextRole });$/", "language": "JavaScript", "kind": "constant"}, {"_type": "tag", "name": "setApiAvailable", "path": "/home/kavia/workspace/code-generation/weekly-progress-insights-platform-22351-22360/weekly_report_frontend/src/pages/AdminUsers.jsx", "pattern": "/^  const [apiAvailable, setApiAvailable] = React.useState(false);$/", "language": "JavaScript", "kind": "constant"}, {"_type": "tag", "name": "setError", "path": "/home/kavia/workspace/code-generation/weekly-progress-insights-platform-22351-22360/weekly_report_frontend/src/pages/AdminUsers.jsx", "pattern": "/^  const [error, setError] = React.useState(null);$/", "language": "JavaScript", "kind": "constant"}, {"_type": "tag", "name": "setLoading", "path": "/home/kavia/workspace/code-generation/weekly-progress-insights-platform-22351-22360/weekly_report_frontend/src/pages/AdminUsers.jsx", "pattern": "/^  const [loading, setLoading] = React.useState(false);$/", "language": "JavaScript", "kind": "constant"}, {"_type": "tag", "name": "setOwnProfileRole", "path": "/home/kavia/workspace/code-generation/weekly-progress-insights-platform-22351-22360/weekly_report_frontend/src/pages/AdminUsers.jsx", "pattern": "/^  const [ownProfileRole, setOwnProfileRole] = React.useState(null);$/", "language": "JavaScript", "kind": "constant"}, {"_type": "tag", "name": "setRowBusy", "path": "/home/kavia/workspace/code-generation/weekly-progress-insights-platform-22351-22360/weekly_report_frontend/src/pages/AdminUsers.jsx", "pattern": "/^  const [rowBusy, setRowBusy] = React.useState({}); \\/\\/ { userId: boolean }$/", "language": "JavaScript", "kind": "constant"}, {"_type": "tag", "name": "setUsers", "path": "/home/kavia/workspace/code-generation/weekly-progress-insights-platform-22351-22360/weekly_report_frontend/src/pages/AdminUsers.jsx", "pattern": "/^  const [users, setUsers] = React.useState([]);$/", "language": "JavaScript", "kind": "constant"}, {"_type": "tag", "name": "supabase", "path": "/home/kavia/workspace/code-generation/weekly-progress-insights-platform-22351-22360/weekly_report_frontend/src/pages/AdminUsers.jsx", "pattern": "/^  const supabase = getSupabase();$/", "language": "JavaScript", "kind": "constant"}, {"_type": "tag", "name": "tryLoadOwnProfile", "path": "/home/kavia/workspace/code-generation/weekly-progress-insights-platform-22351-22360/weekly_report_frontend/src/pages/AdminUsers.jsx", "pattern": "/^  const tryLoadOwnProfile = React.useCallback(async () => {$/", "language": "JavaScript", "kind": "constant"}, {"_type": "tag", "name": "userId", "path": "/home/kavia/workspace/code-generation/weekly-progress-insights-platform-22351-22360/weekly_report_frontend/src/pages/AdminUsers.jsx", "pattern": "/^    const userId = u?.id || u?.user_id || null;$/", "language": "JavaScript", "kind": "constant"}], "hash": "d6e147e52faec7af80a774bb391bc582", "format-version": 4, "code-base-name": "weekly_report_frontend", "filename": "weekly_report_frontend/src/pages/AdminUsers.jsx", "fields": [{"name": "onClick={loadUsers}", "scope": "onClick", "scopeKind": "class", "description": "unavailable"}, {"name": "aria-busy={loading ? 'true' : 'false'}", "scope": "aria", "scopeKind": "class", "description": "unavailable"}, {"name": "disabled={loading}", "scope": "disabled", "scopeKind": "class", "description": "unavailable"}], "revision_history": [{"140": ""}]}