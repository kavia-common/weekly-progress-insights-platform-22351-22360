{"is_source_file": true, "format": "JavaScript/JSX", "description": "React component 'AdminUsers' implementing an admin UI for user role management, including data fetching, role updating, and guidance when backend API is not configured.", "external_files": ["../context/AuthContext", "../components/ToastProvider", "../components/ConfigWarning", "../lib/supabaseClient", "../services/userAdminService", "react-router-dom", "../utils/toast"], "external_methods": ["useAuth", "useToast", "getSupabase", "getSupabaseConfigStatus", "fetchUsers", "updateUserRole", "getAdminApiStatus", "showApiError", "showApiInfo", "showApiSuccess", "Link"], "published": ["AdminUsers"], "classes": [], "methods": [{"name": "loadUsers", "description": "Asynchronous function to load user data from the backend API, updating state and handling errors."}, {"name": "tryLoadOwnProfile", "description": "Attempts to fetch the current user's profile role from Supabase, if configured."}, {"name": "normalizeRole", "description": "Normalizes user role fields to lowercase string for display and comparison."}, {"name": "onChangeRole", "description": "Handles updating a user's role, providing feedback, and updating local state accordingly."}], "calls": ["getSupabaseConfigStatus", "getSupabase", "useToast", "useAuth", "getAdminApiStatus", "fetchUsers", "showApiSuccess", "showApiError", "updateUserRole", "getSupabase", "supabase.from('profiles').select(...).eq(...).single()"], "search-terms": ["AdminUsers", "role management", "user list", "React useState", "Supabase profile role", "backend API", "user roles", "guidance"], "state": 2, "file_id": 44, "knowledge_revision": 164, "git_revision": "f871e32454865c10952cf59770b61659a0a0ef83", "revision_history": [{"140": ""}, {"164": "f871e32454865c10952cf59770b61659a0a0ef83"}], "ctags": [{"_type": "tag", "name": "AdminUsers", "path": "/home/kavia/workspace/code-generation/weekly-progress-insights-platform-22351-22360/weekly_report_frontend/src/pages/AdminUsers.jsx", "pattern": "/^const AdminUsers = () => {$/", "language": "JavaScript", "kind": "constant"}, {"_type": "tag", "name": "Guidance", "path": "/home/kavia/workspace/code-generation/weekly-progress-insights-platform-22351-22360/weekly_report_frontend/src/pages/AdminUsers.jsx", "pattern": "/^  const Guidance = () => ($/", "language": "JavaScript", "kind": "constant"}, {"_type": "tag", "name": "allowedRoles", "path": "/home/kavia/workspace/code-generation/weekly-progress-insights-platform-22351-22360/weekly_report_frontend/src/pages/AdminUsers.jsx", "pattern": "/^  const allowedRoles = ['employee', 'manager', 'admin'];$/", "language": "JavaScript", "kind": "constant"}, {"_type": "tag", "name": "email", "path": "/home/kavia/workspace/code-generation/weekly-progress-insights-platform-22351-22360/weekly_report_frontend/src/pages/AdminUsers.jsx", "pattern": "/^    const email = u?.email || u?.user_email || null;$/", "language": "JavaScript", "kind": "constant"}, {"_type": "tag", "name": "loadUsers", "path": "/home/kavia/workspace/code-generation/weekly-progress-insights-platform-22351-22360/weekly_report_frontend/src/pages/AdminUsers.jsx", "pattern": "/^            onClick={loadUsers}$/", "language": "JavaScript", "kind": "field", "scope": "onClick", "scopeKind": "class"}, {"_type": "tag", "name": "loadUsers", "path": "/home/kavia/workspace/code-generation/weekly-progress-insights-platform-22351-22360/weekly_report_frontend/src/pages/AdminUsers.jsx", "pattern": "/^  const loadUsers = React.useCallback(async () => {$/", "language": "JavaScript", "kind": "constant"}, {"_type": "tag", "name": "loading", "path": "/home/kavia/workspace/code-generation/weekly-progress-insights-platform-22351-22360/weekly_report_frontend/src/pages/AdminUsers.jsx", "pattern": "/^            aria-busy={loading ? 'true' : 'false'}$/", "language": "JavaScript", "kind": "field", "scope": "aria", "scopeKind": "class"}, {"_type": "tag", "name": "loading", "path": "/home/kavia/workspace/code-generation/weekly-progress-insights-platform-22351-22360/weekly_report_frontend/src/pages/AdminUsers.jsx", "pattern": "/^            disabled={loading}$/", "language": "JavaScript", "kind": "field", "scope": "disabled", "scopeKind": "class"}, {"_type": "tag", "name": "normalizeRole", "path": "/home/kavia/workspace/code-generation/weekly-progress-insights-platform-22351-22360/weekly_report_frontend/src/pages/AdminUsers.jsx", "pattern": "/^  const normalizeRole = (u) => {$/", "language": "JavaScript", "kind": "constant"}, {"_type": "tag", "name": "onChangeRole", "path": "/home/kavia/workspace/code-generation/weekly-progress-insights-platform-22351-22360/weekly_report_frontend/src/pages/AdminUsers.jsx", "pattern": "/^  const onChangeRole = async (u, nextRole) => {$/", "language": "JavaScript", "kind": "constant"}, {"_type": "tag", "name": "r", "path": "/home/kavia/workspace/code-generation/weekly-progress-insights-platform-22351-22360/weekly_report_frontend/src/pages/AdminUsers.jsx", "pattern": "/^    const r =$/", "language": "JavaScript", "kind": "constant"}, {"_type": "tag", "name": "res", "path": "/home/kavia/workspace/code-generation/weekly-progress-insights-platform-22351-22360/weekly_report_frontend/src/pages/AdminUsers.jsx", "pattern": "/^      const res = await updateUserRole({ userId, email, role: nextRole });$/", "language": "JavaScript", "kind": "constant"}, {"_type": "tag", "name": "setApiAvailable", "path": "/home/kavia/workspace/code-generation/weekly-progress-insights-platform-22351-22360/weekly_report_frontend/src/pages/AdminUsers.jsx", "pattern": "/^  const [apiAvailable, setApiAvailable] = React.useState(false);$/", "language": "JavaScript", "kind": "constant"}, {"_type": "tag", "name": "setError", "path": "/home/kavia/workspace/code-generation/weekly-progress-insights-platform-22351-22360/weekly_report_frontend/src/pages/AdminUsers.jsx", "pattern": "/^  const [error, setError] = React.useState(null);$/", "language": "JavaScript", "kind": "constant"}, {"_type": "tag", "name": "setLoading", "path": "/home/kavia/workspace/code-generation/weekly-progress-insights-platform-22351-22360/weekly_report_frontend/src/pages/AdminUsers.jsx", "pattern": "/^  const [loading, setLoading] = React.useState(false);$/", "language": "JavaScript", "kind": "constant"}, {"_type": "tag", "name": "setOwnProfileRole", "path": "/home/kavia/workspace/code-generation/weekly-progress-insights-platform-22351-22360/weekly_report_frontend/src/pages/AdminUsers.jsx", "pattern": "/^  const [ownProfileRole, setOwnProfileRole] = React.useState(null);$/", "language": "JavaScript", "kind": "constant"}, {"_type": "tag", "name": "setRowBusy", "path": "/home/kavia/workspace/code-generation/weekly-progress-insights-platform-22351-22360/weekly_report_frontend/src/pages/AdminUsers.jsx", "pattern": "/^  const [rowBusy, setRowBusy] = React.useState({}); \\/\\/ { userId: boolean }$/", "language": "JavaScript", "kind": "constant"}, {"_type": "tag", "name": "setUsers", "path": "/home/kavia/workspace/code-generation/weekly-progress-insights-platform-22351-22360/weekly_report_frontend/src/pages/AdminUsers.jsx", "pattern": "/^  const [users, setUsers] = React.useState([]);$/", "language": "JavaScript", "kind": "constant"}, {"_type": "tag", "name": "supabase", "path": "/home/kavia/workspace/code-generation/weekly-progress-insights-platform-22351-22360/weekly_report_frontend/src/pages/AdminUsers.jsx", "pattern": "/^  const supabase = getSupabase();$/", "language": "JavaScript", "kind": "constant"}, {"_type": "tag", "name": "tryLoadOwnProfile", "path": "/home/kavia/workspace/code-generation/weekly-progress-insights-platform-22351-22360/weekly_report_frontend/src/pages/AdminUsers.jsx", "pattern": "/^  const tryLoadOwnProfile = React.useCallback(async () => {$/", "language": "JavaScript", "kind": "constant"}, {"_type": "tag", "name": "userId", "path": "/home/kavia/workspace/code-generation/weekly-progress-insights-platform-22351-22360/weekly_report_frontend/src/pages/AdminUsers.jsx", "pattern": "/^    const userId = u?.id || u?.user_id || null;$/", "language": "JavaScript", "kind": "constant"}], "hash": "1825c8f3b470ccb7527892abc2c0925b", "format-version": 4, "code-base-name": "weekly_report_frontend", "filename": "weekly_report_frontend/src/pages/AdminUsers.jsx", "fields": [{"name": "onClick={loadUsers}", "scope": "onClick", "scopeKind": "class", "description": "unavailable"}, {"name": "aria-busy={loading ? 'true' : 'false'}", "scope": "aria", "scopeKind": "class", "description": "unavailable"}, {"name": "disabled={loading}", "scope": "disabled", "scopeKind": "class", "description": "unavailable"}]}